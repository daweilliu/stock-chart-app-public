<app-header
  [symbol]="symbol"
  [range]="range"
  [timeframe]="timeframe"
  [fullName]="fullName"
  [isLoadingName]="isLoadingName"
  [latestHigh]="latestHigh"
  [latestLow]="latestLow"
  [latestOpen]="latestOpen"
  [latestClose]="latestClose"
  [latestChangePct]="latestChangePct"
  [latestBarColor]="latestBarColor"
  [showPanel]="showPanel"
  [showWatchlist]="showWatchlist"
  (symbolChange)="symbol = $event"
  (rangeChange)="range = $event"
  (timeframeChange)="onTimeframeChange($event)"
  (showPanelChange)="toggleSettingsPanel()"
  (showWatchlistChange)="toggleWatchlistPanel()"
  (loadSymbol)="loadSymbol($event)"
></app-header>

<div class="main-content">
  <as-split
    #mySplit
    direction="horizontal"
    [useTransition]="false"
    [gutterSize]="4"
    (dragProgress)="onDragProgress($event)"
    (dragEnd)="onSplitterDragEnd()"
  >
    <as-split-area [size]="showPanel || showWatchlist ? 85 : 100" minSize="300">
      <div class="chart-area">
        <div class="chart-container">
          <app-stock-chart
            [symbol]="symbol"
            [range]="range"
            [timeframe]="timeframe"
            [showDMark]="showDMark"
            [showVolumeOverlap]="showVolumeOverlap"
            [showSma1]="smas[0]?.enabled ?? false"
            [sma1Period]="smas[0]?.value ?? 5"
            [showSma2]="smas[1]?.enabled ?? false"
            [sma2Period]="smas[1]?.value ?? 21"
            [showSma3]="smas[2]?.enabled ?? false"
            [sma3Period]="smas[2]?.value ?? 60"
            [showSma4]="smas[3]?.enabled ?? false"
            [sma4Period]="smas[3]?.value ?? 120"
            [showSma5]="smas[4]?.enabled ?? false"
            [sma5Period]="smas[4]?.value ?? 240"
            (latestBar)="onLatestBar($event)"
            (barClicked)="onLatestBar($event)"
          ></app-stock-chart>
        </div>
      </div>
    </as-split-area>
    <as-split-area
      *ngIf="showPanel || showWatchlist"
      [size]="15"
      minSize="160"
      maxSize="320"
    >
      <div class="side-panel-area">
        <app-settings-panel
          *ngIf="showPanel && !showWatchlist"
          [showDMark]="showDMark"
          (showDMarkChange)="onShowDMarkChange($event)"
          [showVolumeOverlap]="showVolumeOverlap"
          (showVolumeOverlapChange)="onShowVolumeOverlapChange($event)"
          [showSma]="showSma"
          (showSmaChange)="onShowSmaChange($event)"
          [smas]="smas"
          (smasChange)="onSmasChange($event)"
        >
          (apply)="onSettingsApply()" (close)="toggleSettingsPanel()"
          ></app-settings-panel
        >
        <app-watchlist-panel
          *ngIf="showWatchlist && !showPanel"
          [symbols]="watchlist"
          (select)="onWatchlistSelect($event)"
          (close)="toggleWatchlistPanel()"
          (addToDB)="addToWatchlist($event)"
          (removeFromDB)="removeFromWatchlist($event)"
        ></app-watchlist-panel>
      </div>
    </as-split-area>
  </as-split>
</div>
